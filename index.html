<!DOCTYPE html>
<html>

  <head>
	<meta name="generator" content="Hugo 0.54.0" />

  <title>
      
      Bugs and Bunnies -- Jay Lyerly
      
  </title>

</head>


  <body>

    

	
<div class="h-feed">

	
	
	  <div class="h-entry">
		
			<h1><a href="https://www.bugsandbunnies.org/2023/05/30/california-dreamin.html">California Dreamin&#39; 2023</a></h1>
		

		<a href="https://www.bugsandbunnies.org/2023/05/30/california-dreamin.html" class="u-url"><time class="dt-published" datetime="2023-05-30 15:59:05 -0400">May 30, 2023</time></a>

		<div class="e-content">
			 

<p>It&rsquo;s about a week before WWDC 2023 kicks off in sunny California, so here&rsquo;s a list of things I&rsquo;m hoping to see come out of Cupertino.  I&rsquo;m skipping the AR/VR stuff, since it&rsquo;s been speculated ad nauseam.  I&rsquo;m sure it&rsquo;ll be cool and awesome and weird and probably not cheap.  And maybe it&rsquo;ll make me dizzy</p>

<blockquote>
<p>TLDR; Better Xcode, Better Siri, Better Mac Catalyst</p>
</blockquote>

<h2 id="xcode">Xcode</h2>

<p>Mostly, I just want Xcode to be better.  Don&rsquo;t crash.  Don&rsquo;t be slow.  Is that too much to ask?</p>

<h4 id="spm-handling">SPM Handling</h4>

<p>We&rsquo;ve all seen it.  Switch branches, hit build and be faced with</p>

<blockquote>
<p>Build operations are disabled: Package loading in progress. Please try again later.</p>
</blockquote>

<p>I spend a lot of time working on <a href="https://www.callistoapp.com">Callisto</a>, which is kind of a big app.  We have dependencies split out into frameworks and it can take SPM <em>a while</em> to resolve all the packages when switching branches.  So I hit this quite a lot.  Usually, Xcode does a great job of queueing up actions when it&rsquo;s busy.  Like if you do a clean build and then run unit tests, it will finish the clean and then do the testing.  That&rsquo;s all I want for SPM resolution.</p>

<h4 id="better-swiftui-tooling">Better SwiftUI Tooling</h4>

<p>I haven&rsquo;t written a lot of SwiftUI.  We toyed with it early on building <a href="https://www.callistoapp.com">Callisto</a>, but it wasn&rsquo;t ready for a big project like that.  A couple months ago, we thought about trying to build a screen here or there with SwiftUI, but ran into roadblocks.  One of the key features of SwiftUI is the <em>live preview</em>.  To make those work, Xcode compiles bits of your code behind the scenes and shows them in preview pane.  <a href="https://www.callistoapp.com">Callisto</a> is a Catalyst app but has an AppKit plugin for doing Mac system things.  Xcode could not handle that when trying to make a SwiftUI preview.  Xcode would try to compile the AppKit code with UIKit and become very upset when it didn&rsquo;t work.  That left our foray into SwiftUI dead in the water.</p>

<h4 id="siri-for-xcode">Siri for Xcode</h4>

<p>I&rsquo;ve dabbled a bit with ChatGPT as a coding assistant.  It&rsquo;s great for small tasks with fiddly parameters.  For instance, I needed to get the timestamp of some files.  That&rsquo;s the kind of thing that&rsquo;s straightforward, but you don&rsquo;t do it often, so you have to look up the specific API to stat the file and which attributes correspond to the creation date / modification date, etc.  ChatGPT spit that code right out and I could move on to other things.  But there&rsquo;s friction there and the opportunity for a bespoke Xcode experience.  I&rsquo;m cautiously optimistic Apple will do something in this space, but I&rsquo;m afraid it won&rsquo;t be groundbreaking.  Because, you know&hellip; Siri.</p>

<h2 id="catalyst-and-ios-updates">Catalyst and iOS Updates</h2>

<p>Since <a href="https://www.callistoapp.com">Callisto</a> is built with Mac Catalyst, these are the sorts of updates we&rsquo;d love to see as developers.</p>

<h4 id="dynamic-type-on-mac">Dynamic Type on Mac</h4>

<p>Dynamic Type on iOS has been around for 10+ years.  That&rsquo;s the bit in iOS Settings that lets you make the text on your device a little bigger or a lot bigger than standard.  All the apps that support Dynamic Type will pick up the change and text across the whole device changes size.  That&rsquo;s great!  A boon for aging eyes everywhere.</p>

<p>But it isn&rsquo;t supported at all on macOS.  This <a href="https://www.apple.com/newsroom/2023/05/apple-previews-live-speech-personal-voice-and-more-new-accessibility-features/">recent announcement</a> about new accessibility features coming in iOS 17 mentions</p>

<blockquote>
<p>For users with low vision, Text Size is now easier to adjust across Mac apps such as Finder, Messages, Mail, Calendar, and Notes.</p>
</blockquote>

<p>That sounds a lot like Dynamic Text on the Mac, so fingers crossed.</p>

<h4 id="auxiliary-window-replacement">Auxiliary Window Replacement</h4>

<p>Back in the day, lots of Mac apps used auxiliary windows that served as things like inspectors and floating tool panels.  Apps like Photoshop had a bunch of these &ndash; paintbrushes, color panels, etc.  You can still see these in AppKit apps like Preview and Quicktime Player, where the inspector is an auxiliary window.  When you switch apps, it disappears to cut down on clutter.  Right now, there&rsquo;s nothing like that for Catalyst.  The UIScene API for managing windows doesn&rsquo;t have that level of distinction.  Hopefully, at WWDC we&rsquo;ll see a more mature Stage Manager implementation and at least some way of distinguishing main content windows and helper windows.</p>

<h4 id="multiple-processes-on-ios">Multiple Processes on iOS</h4>

<p><a href="https://www.callistoapp.com">Callisto</a> includes an embedded Python distribution for running the Jupyter Python Kernel.  On the Mac, we just spawn a separate process and run Python normally.  On iPad, we use a heavily modified Python to run in the same process space as the app to comply with App Store requirements.  In practice, that hamstrings <a href="https://www.callistoapp.com">Callisto</a> on the iPad a great deal.  With a renewed interest in <a href="https://www.apple.com/newsroom/2023/05/apple-brings-final-cut-pro-and-logic-pro-to-ipad/">Pro apps</a> on the iPad, it&rsquo;d be incredible if we were allowed to run multiple processes and level the playing field between an M1 iPad and an M1 MacBook.</p>

<p>Yeah, never going to happen.</p>

<h2 id="other-stuff">Other Stuff</h2>

<h4 id="passwords">Passwords</h4>

<p>A lot of folks have called for a dedicated Passwords app instead of burying password management in Settings.  I&rsquo;m all for that, but I&rsquo;d also love to see password sharing via your Apple Family.  That&rsquo;s really the last feature I&rsquo;d need to leave 1Password behind.  1Password has been fantastic, but they&rsquo;ve really pivoted to a corporate focus, so they&rsquo;re less of good fit when I just want to share the Netflix password with my family.  (Only for persons in my immediate family, residing in the same household.  Netflix, if you&rsquo;re reading this, I promise.)</p>

<h4 id="hksv-streaming-api">HKSV Streaming API</h4>

<p>I&rsquo;m pretty heavily invested in the HomeKit ecosystem and I&rsquo;m mostly happy with it.  (I&rsquo;m looking at you Siri.)  I&rsquo;ve got several third party apps that will stream video from my cameras, but they can only show live feeds.  HKSV (HomeKit Secure Video) records events from these cameras and saves to iCloud, but scrolling back through time is only available via Apple&rsquo;s Home app.  Third party apps aren&rsquo;t able to access the history of clips because there&rsquo;s just no API for it.  With HomeKit (hopefully) maturing a little more this year, Apple should make that available to developers.</p>

<h4 id="better-siri-for-mac">Better Siri for Mac</h4>

<p>Yes, macOS has Siri.  But as underwhelming as Siri is on iOS, it&rsquo;s worse on Mac.</p>

<p>In my notes, I wrote down &ldquo;Not Brain Dead&rdquo;.  Siri just fails at the most basic things sometimes.  When I try to open an app in my Applications folder with the phrase &ldquo;Open AppName&rdquo;, it fails maybe 2 out of 3 times.  I&rsquo;m not sure why it&rsquo;s so bad and I don&rsquo;t know of any way to debug it.</p>

<p>I usually use my laptop with the lid closed with external monitor, keyboard, webcam, etc.  That means I can&rsquo;t use &ldquo;Hey Siri&rdquo; for security reasons.  I agree being able to turn off an always-on microphone is important, but if Siri is a serious feature, why can&rsquo;t I explicitly grant permission for Siri to listen with an external microphone?  It is interesting to note that &ldquo;Hey Siri&rdquo; does work with the ($1600) Mac Studio Display.  That&rsquo;s attributed to the onboard A13 chip.</p>

<p>Another bit of low hanging fruit for Siri is menu commands.  At least it seems low hanging to me.  If I&rsquo;m using an app like Xcode, that has a menu command called &lsquo;Build&rsquo;, I would expect Siri to understand if I said &ldquo;Hey Siri, Build&rdquo;.  But like the double meat burger, Siri is strictly off the menu.</p>

<p>But the real dream is a conversational Siri.  We&rsquo;ve all seen Iron Man.  We&rsquo;ve seen Tony talking to Jarvis like a person as he works.  Could Siri ever do that in the context of Xcode?  Playing with ChatGPT has teased this kind of reality.  &ldquo;Write a method to delete all the files in a given directory.&rdquo;  That&rsquo;s a thing ChatGPT can do in a web browser window.  Why can&rsquo;t Siri to do that in Xcode?  Imagine an Apple trained <a href="https://en.wikipedia.org/wiki/Large_language_model">LLM</a> that especially knew about Swift, UIKit, and all the Apple technologies.  Add in the context of the project you&rsquo;re currently working on.  Talk about a developer accelerant.  But that&rsquo;s a <em>big</em> leap, so it&rsquo;s doubtful we&rsquo;ll see that this year, but maybe the first step?</p>

<h2 id="things-we-won-t-see-at-wwdc">Things We Won&rsquo;t See at WWDC</h2>

<h4 id="apple-silicon-mac-pro">Apple Silicon Mac Pro</h4>

<p>Apple announced Apple Silicon for Mac at WWDC of 2020, three years ago, and the first commercial M1 Macs shipped in November of 2020.  At the time, Apple <a href="https://www.apple.com/newsroom/2020/06/apple-announces-mac-transition-to-apple-silicon/">estimated</a> that the transition to Apple Silicon would take about two years.  It&rsquo;s been two and a half years since that first M1 MacBook Air shipped but the Mac Pro still sports an Intel chip.  Something has clearly run amok.</p>

<p>But the rumor mill is pretty quiet on the Mac Pro front.  Usually at this point, there would be at least some mention of the debut of a high profile, flagship Mac.  It seems like we&rsquo;ll be waiting until later in the year to see what kind of behemoth you can build out of lots of iPhone chips.</p>

<h4 id="homepod-appletv">HomePod + AppleTV</h4>

<p>Years ago, HomePod ran its own fork of iOS called AudioOS.  Apple merged AudioOS with tvOS several revisions back so now both these home devices run tvOS.  Because they do similar things &ndash; played media and power HomeKit &ndash; that makes a lot of sense.  But the two devices remained separate at a hardware level &ndash; a smart speaker and a TV streamer.  I&rsquo;ve been waiting for the hybrid devices for <em>years</em> now.  There&rsquo;s the HomePod with a screen, like an Amazon Echo Show, that does HomePod things, but augmented with a display.  And there&rsquo;s the AppleTV with a mic and speaker.  The mic let&rsquo;s you talk to the TV without holding the button on the remote and the speaker acts as a center channel for multiple HomePod sound stage.</p>

<p>Those are both consumer products, so not the kind of thing they&rsquo;d squeeze into the WWDC Keynote, especially with the AR/VR announcement, but maybe this fall, just in time for Christmas.</p>

<p>Will we see any of this at WWDC?  I certainly hope so.  But there&rsquo;s only one way to find out.</p>

<p>No sleep &lsquo;til DubDub!</p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://www.bugsandbunnies.org/2023/05/26/remember-two-door.html" class="u-url"><time class="dt-published" datetime="2023-05-26 08:42:45 -0400">May 26, 2023</time></a>

		<div class="e-content">
			 <p>Remember two door cars?  Pepperidge Farm remembers.</p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://www.bugsandbunnies.org/2023/05/25/got-some-spam.html" class="u-url"><time class="dt-published" datetime="2023-05-25 09:30:03 -0400">May 25, 2023</time></a>

		<div class="e-content">
			 <p>Got some spam email today promising to use AI to increase my sales meetings by 10x!  Thank you AI, you know just what I want.  Coming soon &ndash; recreational root canals, weekend tax audits and more sauerkraut.</p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://www.bugsandbunnies.org/2023/05/23/pricing-schemes-for.html" class="u-url"><time class="dt-published" datetime="2023-05-23 15:31:56 -0400">May 23, 2023</time></a>

		<div class="e-content">
			 <p>Pricing schemes for streaming services are weird. Most of them charge more for higher quality streams. So you get the same content, just an inferior version of it. It&rsquo;s the equivalent of going to the Louvre and being allowed closer to the Mona Lisa if you paid more.</p>

<blockquote><em>"There's something so human about taking something great, and ruining it a little so you can have more of it." -- Michael, The Good Place</em> </blockquote>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://www.bugsandbunnies.org/2023/05/09/about-final-cut.html" class="u-url"><time class="dt-published" datetime="2023-05-09 11:17:43 -0400">May 9, 2023</time></a>

		<div class="e-content">
			 <p>About Final Cut for iPad&hellip; so many MacRumors commenters are writing it off because it&rsquo;s a subscription - $5/mth or $50/yr. But Mac FCP is $300! So the part where Apple &ldquo;wins” on this is at 6 yeas. If FCP is so good that you&rsquo;re still using it in 6 years, then they totally deserve the money. It also means dabblers like me can pay $10 a year and do the two little hobby projects that come up where multi-cam would be handy. I can only imagine the fury if Apple had dropped a one-time $300 iPad app.</p>

		</div>
	  </div>
	
	  <div class="h-entry">
		
			<h1><a href="https://www.bugsandbunnies.org/2023/04/24/better-app-launching.html">Better App Launching with SwiftUI for Unit Tests</a></h1>
		

		<a href="https://www.bugsandbunnies.org/2023/04/24/better-app-launching.html" class="u-url"><time class="dt-published" datetime="2023-04-24 13:56:15 -0400">Apr 24, 2023</time></a>

		<div class="e-content">
			 <pre>
TL;DR -- In SwiftUI, use a fake testing `App` instead of your real `App` 
to make sure you're actually testing your code. 
</pre>

<p>For unit testing, test coverage is an important metric.  How much of your code base are you exercising during unit tests?  Xcode is, unfortunately, not too bright when it comes to measuring coverage.  It doesn&rsquo;t have the intelligence to know if you&rsquo;re &ldquo;testing&rdquo; a line of code, just that the line of code was executed.  This is a problem right off the bat.</p>

<p>I&rsquo;ve got a new app project in Xcode.  The app does a little and I want to start adding tests before it gets too big.  So I add a unit test target and Xcode plops in some empty tests.  I run the unit tests, and they all pass since they&rsquo;re empty.  I check the coverage and it&rsquo;s at 36%!  How can that be, I didn&rsquo;t test <em>anything</em>?</p>

<p>Xcode, the blissful idiot, is really reporting that 36% of the code was executed while running the unit tests.  Usually, when an app starts up, it does some bootstrapping.  You might set up your persistent storage, draw a couple of Views on screen, and maybe talk to the network.  Xcode counts all that as &ldquo;testing&rdquo; because it ran during a unit test.</p>

<p>To make the test coverage more accurate, we need to do as little as possible outside of our actual unit tests.  Jon Reid <a href="https://qualitycoding.org/ios-app-delegate-testing/">has a write-up</a> of how to do this with a UIKit app by swapping out the app delegate during tests.  But SwiftUI introduces a whole new startup sequence so we need a new approach for SwiftUI&rsquo;s new app lifecycle.</p>

<p>After some futzing around, turns out it&rsquo;s easy!</p>

<pre><code class="language-swift">struct TestApp: App {					// 1
    var body: some Scene {
        WindowGroup {
            Text(&quot;I'm running tests!&quot;)
        }
    }
}

@main										// 2
struct TestDriver {
    static func main() {
        if NSClassFromString(&quot;XCTestCase&quot;) != nil {    // 3
            TestApp.main()
        } else {
            MyRealApp.main()
        }
    }
}
</code></pre>

<p>There are three key points that make this work:</p>

<ol>
    <li>We need a dummy `App` struct to use instead of the real app.  This simple stand-in circumvents all your usual app startup machinery.  Instead of all the normal bootstrapping, we'll just get a window with the text "I'm running tests!".</li>
<li>Remove the `@main` from your `App` implementation and add it here to `TestDriver`.  Swift uses `@main` to figure out how to start your app.  The `App` protocol provides a default implementation that, according to the docs, 'manages the launch process in a platform-appropriate way'.  But by inserting our own wrapper layer here around, we can control _which_ `main()` is called.</li>
<li>That brings us to the final point, use the good old `NSClassFromString` to decide if the testing bundle has been injected into our process.  `XCTestCase` is only available during testing, so this is a reliable way to decide if unit testing is underway.  Based on that, we can call the `main` method of either our real app or our testing stand-in.  It turns out that the default implementation of `main` knows to use its parent struct to bootstrap the SwiftUI app.</li>
</ol>

<p>Now when I run unit tests, my coverage is at 0.8%!  That&rsquo;s more like it.  In order to boost my test coverage, I now have to actually test code.  And the code coverage metric really starts to mean something.</p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://www.bugsandbunnies.org/2023/04/18/life-uh-finds.html" class="u-url"><time class="dt-published" datetime="2023-04-18 09:46:16 -0400">Apr 18, 2023</time></a>

		<div class="e-content">
			 <p><em>Life, uh… finds a way
</em>
<p><a href="https://9to5mac.com/2023/04/18/kindle-unlimited-porn/">Kindle Unlimited porn discovered by parents; Apple &lsquo;concerned&rsquo;</a></p></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://www.bugsandbunnies.org/2023/04/14/hey-no-cameras.html" class="u-url"><time class="dt-published" datetime="2023-04-14 10:41:31 -0400">Apr 14, 2023</time></a>

		<div class="e-content">
			 <p>Hey!  No cameras! #BunnyButtFriday #RabbitsOfMastodon</p>

<p><img src="uploads/2023/361c425a6b.jpg" width="450" height="600" alt=""></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		
			<h1><a href="https://www.bugsandbunnies.org/2023/04/12/unit-testing-with.html">Unit testing with UIDocumentPickerViewController -- An Un-Googlable Bug</a></h1>
		

		<a href="https://www.bugsandbunnies.org/2023/04/12/unit-testing-with.html" class="u-url"><time class="dt-published" datetime="2023-04-12 11:04:29 -0400">Apr 12, 2023</time></a>

		<div class="e-content">
			 <p>TLDR &ndash; If your unit tests crash with <code>DocumentManager service tried to send a message to a deallocated host proxy</code>, make sure you&rsquo;re dismissing any presented instance of UIDocumentPickerViewController.</p>

<p>In our <a href="https://callistoapp.com">Callisto</a> Xcode project, we&rsquo;ve got a lot of unit tests.  Like over a thousand.  We&rsquo;re at the point where if tests have a 0.1% chance of failing, then it happens <em>every time</em>.  Our tests need to be really rock solid, or there&rsquo;s no way we&rsquo;ll get a clean run which is the only way CI will let a build through.</p>

<p>Some time ago, we started noticing the occasional test failure with an uncaught exception:</p>

<blockquote>
DocumentManager service tried to send a message to a deallocated host proxy
</blockquote>

<p>It would crop up when running test both locally and in CI.  With so many tests, we get the weird edge case now and then, but they&rsquo;re not worth the time to track down.  We ignored it.  With the recent update to Xcode 14.3 and macOS 13.3, the DocManager exception went from occasional annoyance to &lsquo;omg, this happens every time I unit test on iOS&rsquo;.  So now we have to fix it.</p>

<p>But what&rsquo;s a DocManager?  IDK &ndash; there&rsquo;s nothing with that name in our code and nothing in the docs about an Apple framework called DocManager.  Looking through the traceback, it&rsquo;s pretty obvious that it&rsquo;s some kind of internal Apple thing.  Surprisingly, a Google search for this error returns <em>absolutely no results</em>.  That&rsquo;s never a good sign.</p>

<p>But what&rsquo;s a DocManager do?  Callisto is UIDocument based, so maybe DocManager manages documents?  A bunch of the unit tests open instances of a UIDocument and aren&rsquo;t 100% about cleaning those up, so maybe some housekeeping will help.  Cue the plumbing montage.  We added a some bookkeeping to make sure that any open UIDocuments were closed at the end of each test, so now we&rsquo;re sure there are no dangling UIDocuments.  No impact &ndash; still the DocManager throws the exception.</p>

<p>This particular problem is a huge pain to track down.  Somewhere in the tests, things get into a bad state.  Later, while another test is running, some background thread discovers the bad state and throws an exception.  The cause of the crash and the actual crashing are quite loosely coupled, making it hard to pin down the culprit.  It also means that the offending tests will run just fine by itself, but only cause a crash when a large number of tests run, giving the background issue time to percolate to the surface.</p>

<p>After a couple hours of testing the tests and narrowing down which ones fail, it started to look like UIDocumentPickerViewController might be involved.  We&rsquo;ve got some ViewControllers that open a docPicker and get feedback via the docPicker&rsquo;s delegate methods.  To test those, we programmatically tap a button to cause the dockPicker to be presented, get a handle to that docPicker and call the delegate with the docPicker and some fake results.  This works great for testing!  Except for that pesky exception that gets thrown now and then.</p>

<p>If we take a closer look at the exception, we&rsquo;ll see there&rsquo;s a little more info attached in the userInfo dict, specifically a file and line number, DOCRemoteViewControlller.m line 42.  Not that we have access to the source, but the name of the file, &ldquo;Remote View Controller&rdquo;, does offer a hint of its purpose.  Those docPicker view controllers offer our app an escape hatch out of the sandbox and into the rest of the file system on the device.  In my limited understanding, the docPickers interface with a separate process that manages file system access, so they actually represent some state from another (<strong>remote</strong>) long lived process.  In the end, these dangling, un-dismissed docPickers were the root of the problem.  Make sure all your UIDocumentPickerViewControllers are dismissed properly and the problem goes away.</p>

<p>Whew!</p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://www.bugsandbunnies.org/2023/04/11/excuse-me-waiter.html" class="u-url"><time class="dt-published" datetime="2023-04-11 14:33:56 -0400">Apr 11, 2023</time></a>

		<div class="e-content">
			 <p>Excuse me waiter, there&rsquo;s a bit of hay in my water.  #RabbitsOfMastodon</p>

<p><img src="https://cdn.uploads.micro.blog/47978/2023/e416cb60d2.jpg" width="483" height="600" alt="A big ruby eyed white rabbit looks at the camera, expressing her impatience because there is a large hay cake in her water bowl.  "></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://www.bugsandbunnies.org/2023/01/07/philosophical-dragon.html" class="u-url"><time class="dt-published" datetime="2023-01-07 15:10:31 -0400">Jan 7, 2023</time></a>

		<div class="e-content">
			 <p>Philosophical Dragon</p>

<p><img src="https://cdn.uploads.micro.blog/47978/2023/55d522ccb0.jpg" width="450" height="600" alt=""></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		
			<h1><a href="https://www.bugsandbunnies.org/2023/01/04/marsedit.html">MarsEdit 5</a></h1>
		

		<a href="https://www.bugsandbunnies.org/2023/01/04/marsedit.html" class="u-url"><time class="dt-published" datetime="2023-01-04 11:12:52 -0400">Jan 4, 2023</time></a>

		<div class="e-content">
			 <p>Tried to pay for an upgrade to MarsEdit 5 this morning, but it wouldn&rsquo;t let me.  The web store said I had purchased MarsEdit 4 too recently, and it gave me a free upgraded to version 5.  Nice!</p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://www.bugsandbunnies.org/2022/11/27/greg-garcias-sprung.html" class="u-url"><time class="dt-published" datetime="2022-11-27 15:32:18 -0400">Nov 27, 2022</time></a>

		<div class="e-content">
			 <p>Greg Garcia’s Sprung on Amazon Prime Video is quite good. He’s the creator behind My Name is Earl and Raising Hope. If you liked those, Sprung will be right up your alley. Some familiar faces too. So good.</p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://www.bugsandbunnies.org/2022/09/11/the-thinking-brick.html" class="u-url"><time class="dt-published" datetime="2022-09-11 20:00:12 -0400">Sep 11, 2022</time></a>

		<div class="e-content">
			 <p>The Thinking Brick</p>

<p><img src="https://cdn.uploads.micro.blog/47978/2022/6c1f906e1c.jpg" width="600" height="450" alt="" /></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		
			<h1><a href="https://www.bugsandbunnies.org/2022/09/09/a-new-watch.html">A New Watch!</a></h1>
		

		<a href="https://www.bugsandbunnies.org/2022/09/09/a-new-watch.html" class="u-url"><time class="dt-published" datetime="2022-09-09 09:05:01 -0400">Sep 9, 2022</time></a>

		<div class="e-content">
			 <p>I took the plunge and ordered a new <a href="https://www.apple.com/apple-watch-ultra/">Ultra</a> Apple Watch sight unseen.  I&rsquo;m very excited for a new wrist computer, especially with a big orange button!  Seems weird though that there&rsquo;s no <em>titanium</em> watch band to dress it up.  I guess Apple is going full tilt on the outdoor adventure lifestyle to start.  The fancy matching titanium band will probably show up in the spring.</p>

<p>(I desperately want to make an <a href="https://en.wikipedia.org/wiki/Ultraman">Ultraman</a> joke, but <em>obviously</em> I&rsquo;m no Ultraman.)</p>

		</div>
	  </div>
	
	  <div class="h-entry">
		
			<h1><a href="https://www.bugsandbunnies.org/2022/08/19/holy-shift-koenigseggs.html">Holy Shift! Koenigsegg’s New Transmission Is a 6-Speed Manual *and* a 9-Speed Automatic</a></h1>
		

		<a href="https://www.bugsandbunnies.org/2022/08/19/holy-shift-koenigseggs.html" class="u-url"><time class="dt-published" datetime="2022-08-19 14:30:07 -0400">Aug 19, 2022</time></a>

		<div class="e-content">
			 <p>I always wondered if someone would build a clutch-by-wire system like this where there&rsquo;s a gear shift and a clutch, but not physically linked to the drivetrain.  This Koenigsegg gearbox sounds like just the thing.  The problem now is that we&rsquo;re all switching to gear-less electric motors, so will this come to electrics too?  Make &lsquo;em feel like a Miata?  I guess Dodge is going to try with the <a href="https://electrek.co/2022/08/17/dodge-shows-banshee-electric-charger-concept-an-ev-with-exhaust/">eRupt</a>.</p>

<p><a href="https://www.motortrend.com/reviews/koenigsegg-light-speed-transmission-manual-automatic-how-it-works-explained">Holy Shift! Koenigsegg’s New Transmission Is a 6-Speed Manual *and* a 9-Speed Automatic</a>:</p>

<blockquote>"We still are in the process of developing it, but it's already crazy good. When we are done with it, I don't think anyone will be able to tell it apart from a traditional manual. That's the objective. It should feel like a mix between a Mazda Miata and a Ferrari gated shifter. The best of the two worlds."</blockquote>

		</div>
	  </div>
	
	  <div class="h-entry">
		
			<h1><a href="https://www.bugsandbunnies.org/2022/08/19/on-the-occasion.html">Serendipity </a></h1>
		

		<a href="https://www.bugsandbunnies.org/2022/08/19/on-the-occasion.html" class="u-url"><time class="dt-published" datetime="2022-08-19 09:29:46 -0400">Aug 19, 2022</time></a>

		<div class="e-content">
			 <p>On the occasion of a blind squirrel finding a nut.</p>

<p>Wordle 426 2/6
<br>
⬜🟩⬜🟨⬜
<br>
🟩🟩🟩🟩🟩</p>

		</div>
	  </div>
	
	  <div class="h-entry">
		
			<h1><a href="https://www.bugsandbunnies.org/2022/08/12/sponge-worthy.html">Sponge worthy?</a></h1>
		

		<a href="https://www.bugsandbunnies.org/2022/08/12/sponge-worthy.html" class="u-url"><time class="dt-published" datetime="2022-08-12 11:27:03 -0400">Aug 12, 2022</time></a>

		<div class="e-content">
			 <p>My favorite new unix too is definitely <code>sponge</code>.  It&rsquo;s from the <a href="https://joeyh.name/code/moreutils/">moreutils</a> suite, but the easiest way to get it on your Mac is a quick <code>brew install sponge</code>.</p>

<p>You know how <code>sed</code> can edit a file in place?  Dope, right?  <code>sponge</code> makes it easy to do that with <em>all</em> the regular unix tools.  If I want to fix a DOS text file by removing the carriage return, I always try doing</p>

<pre><code>cat my_file.txt | tr -d &quot;\r&quot; &gt; my_file.txt
</code></pre>

<p>But that doesn&rsquo;t work because it starts writing to the file before it&rsquo;s all read and a lot of times, the file ends up empty.  <code>sponge</code> to the rescue!</p>

<pre><code>cat my_file.txt | tr -d &quot;\r&quot; | sponge my_file.txt
</code></pre>

<p><code>sponge</code> will read everything from standard in and then write it out to the given file, so this works like you want it to, even for big files.</p>

<p>Also great with <a href="https://stedolan.github.io/jq/"><code>jq</code></a> for prettifying JSON files in place too.</p>

		</div>
	  </div>
	
	  <div class="h-entry">
		
			<h1><a href="https://www.bugsandbunnies.org/2022/08/10/three-habits.html">Three Habits</a></h1>
		

		<a href="https://www.bugsandbunnies.org/2022/08/10/three-habits.html" class="u-url"><time class="dt-published" datetime="2022-08-10 15:03:08 -0400">Aug 10, 2022</time></a>

		<div class="e-content">
			 <p><em>The three hardest habits to break are heroin, carbs and a steady paycheck.
</em></p>

<p><em>&ndash; Nassim Nicholas Taleb (paraphrased)</em></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		
			<h1><a href="https://www.bugsandbunnies.org/2022/08/08/illinois-tech-spinout.html">Illinois Tech ‘spinout’ startup Influit Energ | EurekAlert!</a></h1>
		

		<a href="https://www.bugsandbunnies.org/2022/08/08/illinois-tech-spinout.html" class="u-url"><time class="dt-published" datetime="2022-08-08 09:34:15 -0400">Aug 8, 2022</time></a>

		<div class="e-content">
			 <p>A research group out of Chicago has developed &ldquo;liquid batteries&rdquo;.  I have no idea how the chemistry of this works, but it sounds like you could refuel an electric car a lot like you&rsquo;d gas up an ICE car, and in a similar amount of time.  And about a billion other applications.</p>

<p><a href="https://www.eurekalert.org/news-releases/961148">Illinois Tech ‘spinout’ startup Influit Energ | EurekAlert!</a>:</p>

<blockquote>The unique high-energy density liquid format of the NEF flow batteries allows use of the same fluids in different devices, meaning fluid, charged at the recharging station from renewable energy sources or a grid, can be used to rapidly refuel vehicles, or for stationary storage and other large portable applications,” Timofeeva says. “Discharged fluid can be returned to a recharge/refuel station for recharging or be charged inside the device by plugging into the power source.</blockquote>

		</div>
	  </div>
	
	  <div class="h-entry">
		
			<h1><a href="https://www.bugsandbunnies.org/2022/08/04/muppet-songs-ernie.html">Muppet Songs: Ernie - Rubber Duckie - YouTube</a></h1>
		

		<a href="https://www.bugsandbunnies.org/2022/08/04/muppet-songs-ernie.html" class="u-url"><time class="dt-published" datetime="2022-08-04 11:27:46 -0400">Aug 4, 2022</time></a>

		<div class="e-content">
			 <p>Today&rsquo;s earworm&hellip;</p>

<p><a href="https://www.youtube.com/watch?v=hBvtD6xs77g">Muppet Songs: Ernie - Rubber Duckie - YouTube</a>:</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/hBvtD6xs77g" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

		</div>
	  </div>
	
	  <div class="h-entry">
		
			<h1><a href="https://www.bugsandbunnies.org/2022/08/03/daring-fireball-whats.html">Daring Fireball: &#39;What&#39;s the Deal With Water Bottles?&#39;</a></h1>
		

		<a href="https://www.bugsandbunnies.org/2022/08/03/daring-fireball-whats.html" class="u-url"><time class="dt-published" datetime="2022-08-03 09:48:52 -0400">Aug 3, 2022</time></a>

		<div class="e-content">
			 <p>From the New Yorker via DF, a delightful survey of comics and their water bottles.  As a kid with cable, I watched a lot of standup, so I found this extremely interesting.  And the presentation is <em>molto bene</em> &ndash; the animated magazine version of the web.</p>

<p><a href="https://daringfireball.net/linked/2022/08/01/water-bottles-standup">Daring Fireball: 'What's the Deal With Water Bottles?'</a>:</p>

		</div>
	  </div>
	
	  <div class="h-entry">
		
			<h1><a href="https://www.bugsandbunnies.org/2022/08/01/tricorders.html">Tricorders</a></h1>
		

		<a href="https://www.bugsandbunnies.org/2022/08/01/tricorders.html" class="u-url"><time class="dt-published" datetime="2022-08-01 16:07:19 -0400">Aug 1, 2022</time></a>

		<div class="e-content">
			 <p>When I was a kid, I expected my tricorder would look like this</p>

<p><img style="display:block; margin-left:auto; margin-right:auto;" src="https://cdn.uploads.micro.blog/47978/2022/36af399d1b.jpg" alt="Yokogawa AQ1200" title="yokogawa-AQ1200.jpg" border="0" width="599" height="486" /></p>

<p>But it turned out like this</p>

<p><img style="display:block; margin-left:auto; margin-right:auto;" src="https://cdn.uploads.micro.blog/47978/2022/8ceebb569f.jpg" alt="158438 phones review iphone 13 pro review a lesson in refinement image5 ws2nobt8ak" title="158438-phones-review-iphone-13-pro-review-a-lesson-in-refinement-image5-ws2nobt8ak.jpg" border="0" width="600" height="400" /></p>

<p>Which still seems weird.</p>

<p>Via <a href="https://wilwheaton.tumblr.com/post/691173806602141696/vizreef-yokogawa-aq1200-multi-field">WIL WHEATON dot TUMBLR dot COM - vizreef: Yokogawa // AQ1200 Multi Field...</a>:</p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://www.bugsandbunnies.org/2021/08/04/twos-company-get.html" class="u-url"><time class="dt-published" datetime="2021-08-04 21:42:00 -0400">Aug 4, 2021</time></a>

		<div class="e-content">
			 <p>Two’s company. Get lost nerd.</p>

<p><img src="https://jaylyerly.micro.blog/uploads/2021/35869d6666.jpg" width="600" height="450" alt="" /></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		
			<h1><a href="https://www.bugsandbunnies.org/2021/08/04/the-mysterious-error.html">The MYSTERIOUS Error.</a></h1>
		

		<a href="https://www.bugsandbunnies.org/2021/08/04/the-mysterious-error.html" class="u-url"><time class="dt-published" datetime="2021-08-04 09:24:31 -0400">Aug 4, 2021</time></a>

		<div class="e-content">
			 <p>Callisto is a Catalyst app, mostly running iOS style code on a Mac.  But there are some things that Catalyst apps can&rsquo;t do &ndash; like run a python server as another process.  But Mac apps can!</p>

<p>There are a lot of instructions around the Internet about how to use AppKit code within your Catalyst app to do those Mac things that Catalyst doesn&rsquo;t cover yet.  <a href="https://www.highcaffeinecontent.com/blog/20190607-Beyond-the-Checkbox-with-Catalyst-and-AppKit">This article</a> from Steve Troughton-Smith was our guide.</p>

<p>We also want to do auto-updates like a regular Mac app.  We&rsquo;re distributing outside the Mac App Store for Reasons, so we&rsquo;re in charge of our own updates.  Yep, dear reader, that means <a href="https://sparkle-project.org">Sparkle</a>, which should be fine, right?  So we get the Sparkle framework and link it in to our AppKit bundle which is a plugin for our main app.  Compile, run and 💥.  This error is staring at us from the console.</p>

<pre><code>code signature in (&lt;full path redacted&gt;/Sparkle.framework/Versions/A/Sparkle) not valid for use 
in process using Library Validation: not allowing mapping of development code into production process
</code></pre>

<p>What does <em>that</em> mean?  After some furious googling, we&rsquo;re left empty handed and confused.  The worst kind of error is that special, <em>new</em> error that no one else has ever seen.  Bollocks.</p>

<p>After some futile futzing around in the dark, I give up and burn a &lsquo;code level&rsquo; support ticket with Apple.  I send a fairly detailed outline of the problem and the next morning I get back a nice response asking for more details.  In particular, how are the app and the framework code signed?  (You can check that with <code>codesign -vvvd &lt;.app or .framework&gt;</code>.)</p>

<p>And immediately, I see it.</p>

<p>App Signature:</p>

<p><code>Authority=Developer ID Application: Oak City Labs, LLC (XXXXXXXXX)</code></p>

<p>Framework Signature:</p>

<p><code>Authority=Apple Development: Continuous Integration (YYYYYYYYY)</code></p>

<p>The app is signed with a <em>production</em> identity while the framework is signed with a <em>development</em> identity.  That&rsquo;s what that weird error meant about <code>not allowing mapping of development code into production process</code>.  The <code>codesign</code> docs point out how frameworks and apps need to both be signed with the same Team ID (which I checked), but don&rsquo;t mention this distinction between production / development signing identities.</p>

<p>I update Xcode so that the AppKit bundle was being signed with the same production identity and all is well!  We are fully Sparkle enabled!  Curiously, the AppKit bundle has always been signed with the development identity before, yet it loaded fine at runtime.  That must be one of those fine distinctions between a bundle and a framework that I don&rsquo;t quite understand.</p>

<p>But now we celebrate!  🎉🎉🎉</p>

		</div>
	  </div>
	
	  <div class="h-entry">
		
			<h1><a href="https://www.bugsandbunnies.org/2021/08/04/throw-some-results.html">Throw some Results </a></h1>
		

		<a href="https://www.bugsandbunnies.org/2021/08/04/throw-some-results.html" class="u-url"><time class="dt-published" datetime="2021-08-04 09:24:01 -0400">Aug 4, 2021</time></a>

		<div class="e-content">
			 <p>Errors, we&rsquo;ve all got &lsquo;em.  What do we do with &lsquo;em?</p>

<p>Swift has a couple of different error handling patterns.  There&rsquo;s <code>try</code> and <code>catch</code> which I always think of as kind of the nuclear option.  Something went wrong, the code blows up with a <code>throw</code> and our hero, the intrepid programmer, has to deal with it right here, right now.  And then there&rsquo;s <code>Result</code>, an elegant weapon for a more civilized age.  Call a method and get back a <code>Result</code>, then deal with it as you like &ndash; check for the value, handle the error or maybe even ignore it altogether.  Depending on your situation, one of these is likely to suit better than the other.</p>

<p>But sometimes the situation changes.  Maybe you wrote some code that should obviously <code>throw</code>(or calls some library code that <code>throws</code>), but it would really make a lot more sense to return a <code>Result</code>.  As it turns out, it&rsquo;s really easy to convert between <code>try</code>/<code>catch</code> and a <code>Result</code> type.</p>

<p>Imagine you have some code that can <code>throw</code>.  Maybe even it always throws, because it is a <code>badIdea()</code>.  But you need to have a <code>Result</code> instance instead.  The <code>Result</code> type has an initializer that handles this perfectly.  You hand it a closure that returns the <code>Success</code> type for the <code>Result</code> and any error thrown by the closure is used for the <code>Failure</code> case.  Basically, they&rsquo;ve wrapped up all the boilerplate in this initializer, and you get a very concise way to convert <code>try</code> into a <code>Result</code>.</p>

<pre><code class="language-swift">enum HorrendousError: Error {
    case veryBad
}

func badIdea() throws -&gt; String {
    throw HorrendousError.veryBad
}

let result = Result&lt;String, Error&gt; { try badIdea() }

</code></pre>

<p>The full signature of that initializer is <code>Result.init(catching: () -&gt; Success)</code>.  The single argument is a closure returns the <code>Success</code> type &ndash; here that&rsquo;s a <code>String</code>.  If the closure throws, then that gets wrapped up as the <code>.failure</code> case.</p>

<p>How about doing the reverse?  You&rsquo;ve got a result type, but you&rsquo;d rather access the value in a <code>try</code> / <code>catch</code> sort of way.  The <code>Result</code> type itself has a accessor method for just such an occasion!</p>

<pre><code class="language-swift">let value = try someResult.get()
</code></pre>

<p>If the <code>Result</code> type is the <code>.success</code> case, it just returns the successful value.  If <code>someResult</code> is a <code>.failure</code> case, the <code>get()</code> method will <code>throw</code>.  This is especially useful if you want to access the result and ignore any errors:</p>

<pre><code class="language-swift">let optionalValue = try? someResult.get()
</code></pre>

<p>This is also handy in testing when you expect a <code>Result</code> type to be successful.  Use the <code>get()</code> method to access the value and let <code>XCTest</code>&rsquo;s support for tests that <code>throw</code> to handle the error cases.  This can make tests shorter and easier to read too.</p>

<p>For me, discovering the interchangeable nature of <code>try</code>/<code>catch</code> and the <code>Result</code> type was a bit of an &lsquo;aha!&rsquo; moment.  You&rsquo;re not locked in to on type of error handling or another.  With these convenient converters, you can fluidly move from one type to another as needed.  And without a lot of boilerplate code for the conversions!</p>

		</div>
	  </div>
	

</div>


    
    <footer class="footer">
  <div class="footer__inner">
    <div class="copyright">
     <center>

        <a rel="me" href="https://mastodon.social/@jaylyerly"><i class="fa-brands fa-mastodon"></i> Follow on Mastodon</a>

      </center>
    </div>
  </div>
</footer>



  </body>

</html>
